#!/bin/sh

# start Xvncserver for gui unit tests to not show
# but don't start Xvncserver when launching the gui
if [[ -e /usr/bin/vncserver && ! "$*" =~ "run" ]]
then
  if [[ ! -e /tmp/.X11-unix/X1 ]]
  then
    echo "starting xvnc"
    /usr/bin/vncserver :1 -localhost -nolisten tcp
  fi
  if [[ -e /tmp/.X11-unix/X1 ]]
  then
    export DISPLAY=:1
  fi
fi

nice -n 15 $(upfind -name gradlew) $*
